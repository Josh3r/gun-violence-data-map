{"version":3,"sources":["../../../src/worker-utils/get-transfer-list.js"],"names":["isTransferable","object","ArrayBuffer","buffer","MessagePort","ImageBitmap","OffscreenCanvas","getTransferList","recursive","transfers","push","key"],"mappings":";;;;;;;;;;;AAMA,SAASA,cAAT,CAAwBC,MAAxB,EAAgC;AAC9B,MAAI,CAACA,MAAL,EAAa;AACX,WAAO,KAAP;AACD;;AACD,MAAIA,MAAM,YAAYC,WAAlB,IAAiCD,MAAM,CAACE,MAAP,YAAyBD,WAA9D,EAA2E;AACzE,WAAO,IAAP;AACD;;AACD,MAAI,OAAOE,WAAP,KAAuB,WAAvB,IAAsCH,MAAM,YAAYG,WAA5D,EAAyE;AACvE,WAAO,IAAP;AACD;;AACD,MAAI,OAAOC,WAAP,oBAAsCJ,MAAM,YAAYI,WAA5D,EAAyE;AACvE,WAAO,IAAP;AACD;;AACD,MAAI,OAAOC,eAAP,oBAA0CL,MAAM,YAAYK,eAAhE,EAAiF;AAC/E,WAAO,IAAP;AACD;;AACD,SAAO,KAAP;AACD;;AAEM,SAASC,eAAT,CAAyBN,MAAzB,EAAmE;AAAA,MAAlCO,SAAkC,uEAAtB,IAAsB;AAAA,MAAhBC,SAAgB,uEAAJ,EAAI;;AACxE,MAAI,CAACR,MAAL,EAAa,CAEZ,CAFD,MAEO,IAAID,cAAc,CAACC,MAAD,CAAlB,EAA4B;AACjCQ,IAAAA,SAAS,CAACC,IAAV,CAAeT,MAAf;AACD,GAFM,MAEA,IAAID,cAAc,CAACC,MAAM,CAACE,MAAR,CAAlB,EAAmC;AAExCM,IAAAA,SAAS,CAACC,IAAV,CAAeT,MAAM,CAACE,MAAtB;AACD,GAHM,MAGA,IAAIK,SAAS,IAAI,yBAAOP,MAAP,MAAkB,QAAnC,EAA6C;AAClD,SAAK,IAAMU,GAAX,IAAkBV,MAAlB,EAA0B;AAExBM,MAAAA,eAAe,CAACN,MAAM,CAACU,GAAD,CAAP,EAAcH,SAAd,EAAyBC,SAAzB,CAAf;AACD;AACF;;AACD,SAAOA,SAAP;AACD","sourcesContent":["// NOTE - there is a copy of this function is both in core and loader-utils\n// core does not need all the utils in loader-utils\n// https://developer.mozilla.org/en-US/docs/Web/API/Transferable\n\n/* global MessagePort, ImageBitmap, OffscreenCanvas */\n\nfunction isTransferable(object) {\n  if (!object) {\n    return false;\n  }\n  if (object instanceof ArrayBuffer || object.buffer instanceof ArrayBuffer) {\n    return true;\n  }\n  if (typeof MessagePort !== 'undefined' && object instanceof MessagePort) {\n    return true;\n  }\n  if (typeof ImageBitmap !== `undefined` && object instanceof ImageBitmap) {\n    return true;\n  }\n  if (typeof OffscreenCanvas !== `undefined` && object instanceof OffscreenCanvas) {\n    return true;\n  }\n  return false;\n}\n\nexport function getTransferList(object, recursive = true, transfers = []) {\n  if (!object) {\n    // ignore\n  } else if (isTransferable(object)) {\n    transfers.push(object);\n  } else if (isTransferable(object.buffer)) {\n    // Typed array\n    transfers.push(object.buffer);\n  } else if (recursive && typeof object === 'object') {\n    for (const key in object) {\n      // Avoid perf hit - only go one level deep\n      getTransferList(object[key], recursive, transfers);\n    }\n  }\n  return transfers;\n}\n"],"file":"get-transfer-list.js"}